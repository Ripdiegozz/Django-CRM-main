{% extends 'base.html' %}

{% block content %}

{% if user.is_authenticated %}

<div class="my-4">
  <form method="get" class="flex flex-wrap gap-3">
    {{ myFilter.form }}
    <div class="flex gap-2 mt-4">
      <button class="btn btn-info" type="submit">Buscar</button>
      <a class="btn btn-secondary" href="/">Limpiar Filtros</a>
    </div>
  </form>
</div>

<table class="table table-striped table-hover table-bordered">
  <thead class="table-dark">
    <tr>
      <th scope="col">Nombre</th>
      <th scope="col">Cédula</th>
      <th scope="col">Fecha del pedido</th>
      <th scope="col">Fecha de entrega</th>
      <th scope="col">Tipo de lente</th>
      <th scope="col">Laboratorio</th>
      <th scope="col">Precio</th>
      <th scope="col">Fórmula</th>
      <th scope="col">Registro creado en</th>
      <th scope="col">ID</th>
      <th scope="col">Editor</th>
    </tr>
  </thead>
  <tbody>

{% if records %}
	{% for record in records %}
		<tr>
			<td>{{ record.first_name }} {{ record.last_name }}</td>
			<td>{{ record.cedula }}</td>
			<td>{{ record.fecha_inicio | date:"SHORT_DATE_FORMAT" }}</td>
			<td>{{ record.fecha_entrega | date:"SHORT_DATE_FORMAT" }}</td>
			<td class="type-desc">{{ record.tipo_lente }}</td>
			<td>{{ record.laboratorio }}</td>
			<td>{{ record.precio }}</td>
			<td class="type-desc">{{ record.formula_lente }}</td>
			<td>{{ record.created_at | date:"d/m/y | h:i:s" }}</td>
			<td>{{ record.id }}</td>
      <td><a href="{% url 'record' record.id %}">Ver registro</a></td>
		</tr>
	{% endfor %}

  {% else %}

  <tr>
    <td colspan="11">No hay registros</td>
  </tr>

{% endif %}

	
	  </tbody>
	</table>





{% else %}

<div class="col-md-6 offset-md-3">
<h1>Login</h1>
<br/>

<form method="POST" action="{% url 'home' %}">
	{% csrf_token %}

  <div class="mb-3">
    <input type="text" class="form-control" name="username", placeholder="Username" required>
    
  </div><br/>
  <div class="mb-3">
    <input type="password" class="form-control" name="password", placeholder="Password" required>
  </div>
  <br/>
  <button type="submit" class="btn btn-secondary">Iniciar Sesión</button>

</form>



{% endif %}

{% endblock %}